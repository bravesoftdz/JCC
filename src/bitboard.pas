{ JCC (Jan's Chess Componenents) - This file contains constants and functions to handle bitboards
  Copyright (C) 2016  Jan Dette

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
}
unit BitBoard;

{$mode objfpc}{$H+}{$J-}

interface

uses
  Classes, SysUtils;

// We map a 8x8 board from the upper left corner (a8) to the lower right corner (h1)
// by going left to right and then up to down.
// So a8 would be 2^0 and h1 is 2^63

type
  TBitBoard = QWord;

const
  // From 1 to 8
  Ranks: array[1..8] of TBitBoard =
    (18374686479671623680, 71776119061217280, 280375465082880,
    1095216660480, 4278190080, 16711680, 65280, 255);

  // From A to H
  Files: array[1..8] of TBitBoard =
    (72340172838076673, 144680345676153346, 289360691352306692, 578721382704613384,
    1157442765409226768, 2314885530818453536, 4629771061636907072, 9259542123273814144);

  // Diagonals from top left to bottom right
  Diagonals: array[1..15] of TBitBoard =
    (1, 258, 66052, 16909320, 4328785936, 1108169199648,
    283691315109952, 72624976668147840, 145249953336295424,
    290499906672525312, 580999813328273408, 1161999622361579520,
    2323998145211531264, 4647714815446351872, 9223372036854775808);

  // Anti-Diagonals from top right to bottom left
  AntiDiagonals: array[1..15] of TBitBoard =
    (128, 32832, 8405024, 2151686160, 550831656968,
    141012904183812, 36099303471055874, 9241421688590303745, 4620710844295151872,
    2310355422147575808, 1155177711073755136, 577588855528488960,
    288794425616760832, 144396663052566528, 72057594037927936);

  // Pre-calculated knight moves from A8 to H1
  KnightMoves: array[0..63] of TBitBoard =
    (132096, 329728, 659712, 1319424, 2638848, 5277696, 10489856,
    4202496, 33816580, 84410376, 168886289, 337772578, 675545156,
    1351090312, 2685403152, 1075839008, 8657044482, 21609056261,
    43234889994, 86469779988, 172939559976, 345879119952, 687463207072,
    275414786112, 2216203387392, 5531918402816, 11068131838464,
    22136263676928, 44272527353856, 88545054707712, 175990581010432,
    70506185244672, 567348067172352, 1416171111120896, 2833441750646784,
    5666883501293568, 11333767002587136, 22667534005174272,
    45053588738670592, 18049583422636032, 145241105196122112,
    362539804446949376, 725361088165576704, 1450722176331153408,
    2901444352662306816, 5802888705324613632, 11533718717099671552,
    4620693356194824192, 288234782788157440, 576469569871282176, 1224997833292120064,
    2449995666584240128, 4899991333168480256, 9799982666336960512,
    1152939783987658752, 2305878468463689728, 1128098930098176, 2257297371824128,
    4796069720358912, 9592139440717824, 19184278881435648, 38368557762871296,
    4679521487814656, 9077567998918656);

  // Pre-calculated king moves from A8 to H1
  KingMoves: array[0..63] of TBitBoard =
    (770, 1797, 3594, 7188, 14376, 28752, 57504, 49216, 197123, 460039,
    920078, 1840156, 3680312, 7360624, 14721248, 12599488, 50463488,
    117769984, 235539968, 471079936, 942159872, 1884319744, 3768639488,
    3225468928, 12918652928, 30149115904, 60298231808, 120596463616,
    241192927232, 482385854464, 964771708928, 825720045568, 3307175149568,
    7718173671424, 15436347342848, 30872694685696, 61745389371392,
    123490778742784, 246981557485568, 211384331665408, 846636838289408,
    1975852459884544, 3951704919769088, 7903409839538176, 15806819679076352,
    31613639358152704, 63227278716305408, 54114388906344448, 216739030602088448,
    505818229730443264, 1011636459460886528, 2023272918921773056,
    4046545837843546112, 8093091675687092224, 16186183351374184448,
    13853283560024178688, 144959613005987840, 362258295026614272,
    724516590053228544, 1449033180106457088, 2898066360212914176,
    5796132720425828352, 11592265440851656704, 4665729213955833856);

  // Empty castling squares e. g. f1, g1 for white kingside, b1, c1, d1 for queenside
  // White: Kingside, Queenside, Black: Kingside, Queenside
  CastlingSquares: array[1..4] of TBitBoard =
    (6917529027641081856, 1008806316530991104, 96, 14);

  // Black and white squares on board
  BlackSquares: TBitBoard = 6172840429334713770;
  WhiteSquares: TBitBoard = 12273903644374837845;

  // Squares between two squares (exclusively)
  // http://chessprogramming.wikispaces.com/Square+Attacked+By#Legality%20Test-In%20Between-Rectangular%20Lookup
  InBetweens: array[0..63, 0..63] of TBitBoard = (
    (0, 0, 2, 6, 14, 30, 62, 126, 0, 0, 0, 0, 0, 0, 0, 0, 256, 0, 512,
    0, 0, 0, 0, 0, 65792, 0, 0, 262656, 0, 0, 0, 0, 16843008, 0, 0, 0,
    134480384, 0, 0, 0, 4311810304, 0, 0, 0, 0, 68853957120, 0, 0,
    1103823438080, 0, 0, 0, 0, 0, 35253226045952, 0, 282578800148736,
    0, 0, 0, 0, 0, 0, 18049651735527936),
    (0, 0, 0, 4, 12, 28, 60, 124, 0, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 1024,
    0, 0, 0, 0, 0, 131584, 0, 0, 525312, 0, 0, 0, 0, 33686016, 0, 0, 0,
    268960768, 0, 0, 0, 8623620608, 0, 0, 0, 0, 137707914240, 0, 0,
    2207646876160, 0, 0, 0, 0, 0, 70506452091904, 0, 565157600297472, 0, 0, 0, 0, 0, 0),
    (2, 0, 0, 0, 8, 24, 56, 120, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 1024,
    0, 2048, 0, 0, 0, 0, 0, 263168, 0, 0, 1050624, 0, 0, 0, 0, 67372032,
    0, 0, 0, 537921536, 0, 0, 0, 17247241216, 0, 0, 0, 0, 275415828480,
    0, 0, 4415293752320, 0, 0, 0, 0, 0, 0, 0, 1130315200594944, 0, 0, 0, 0, 0),
    (6, 4, 0, 0, 0, 16, 48, 112, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1024, 0, 2048,
    0, 4096, 0, 0, 132096, 0, 0, 526336, 0, 0, 2101248, 0, 0, 0, 0,
    134744064, 0, 0, 0, 1075843072, 0, 0, 0, 34494482432, 0, 0, 0, 0,
    0, 0, 0, 8830587504640, 0, 0, 0, 0, 0, 0, 0, 2260630401189888, 0, 0, 0, 0),
    (14, 12, 8, 0, 0, 0, 32, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2048, 0,
    4096, 0, 8192, 0, 0, 264192, 0, 0, 1052672, 0, 0, 4202496, 33818624,
    0, 0, 0, 269488128, 0, 0, 0, 0, 0, 0, 0, 68988964864, 0, 0, 0, 0,
    0, 0, 0, 17661175009280, 0, 0, 0, 0, 0, 0, 0, 4521260802379776, 0, 0, 0),
    (30, 28, 24, 16, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4096,
    0, 8192, 0, 16384, 0, 0, 528384, 0, 0, 2105344, 0, 0, 0, 67637248,
    0, 0, 0, 538976256, 0, 0, 8657571840, 0, 0, 0, 0, 137977929728, 0,
    0, 0, 0, 0, 0, 0, 35322350018560, 0, 0, 0, 0, 0, 0, 0, 9042521604759552, 0, 0),
    (62, 60, 56, 48, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    8192, 0, 16384, 0, 0, 0, 0, 1056768, 0, 0, 4210688, 0, 0, 0, 135274496, 0,
    0, 0, 1077952512, 0, 0, 17315143680, 0, 0, 0, 0, 275955859456, 0,
    2216338399232, 0, 0, 0, 0, 0, 70644700037120, 0, 0, 0, 0, 0, 0, 0,
    18085043209519104, 0),
    (126, 124, 120, 112, 96, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 16384, 0, 32768, 0, 0, 0, 0, 2113536, 0, 0, 8421376, 0, 0, 0,
    270548992, 0, 0, 0, 2155905024, 0, 0, 34630287360, 0, 0, 0, 0,
    551911718912, 0, 4432676798464, 0, 0, 0, 0, 0, 141289400074240,
    567382630219776, 0, 0, 0, 0, 0, 0, 36170086419038208),
    (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 512, 1536, 3584, 7680, 15872, 32256,
    0, 0, 0, 0, 0, 0, 0, 0, 65536, 0, 131072, 0, 0, 0, 0, 0, 16842752,
    0, 0, 67239936, 0, 0, 0, 0, 4311810048, 0, 0, 0, 34426978304, 0, 0,
    0, 1103823437824, 0, 0, 0, 0, 17626613022720, 0, 0, 282578800148480,
    0, 0, 0, 0, 0, 9024825867763712, 0),
    (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1024, 3072, 7168, 15360, 31744, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 131072, 0, 262144, 0, 0, 0, 0, 0, 33685504,
    0, 0, 134479872, 0, 0, 0, 0, 8623620096, 0, 0, 0, 68853956608, 0,
    0, 0, 2207646875648, 0, 0, 0, 0, 35253226045440, 0, 0, 565157600296960, 0,
    0, 0, 0, 0, 18049651735527424),
    (0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 0, 0, 2048, 6144, 14336, 30720, 0,
    0, 0, 0, 0, 0, 0, 0, 131072, 0, 262144, 0, 524288, 0, 0, 0, 0, 0,
    67371008, 0, 0, 268959744, 0, 0, 0, 0, 17247240192, 0, 0, 0, 137707913216,
    0, 0, 0, 4415293751296, 0, 0, 0, 0, 70506452090880, 0, 0, 1130315200593920,
    0, 0, 0, 0, 0),
    (0, 0, 0, 0, 0, 0, 0, 0, 1536, 1024, 0, 0, 0, 4096, 12288, 28672, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 262144, 0, 524288, 0, 1048576, 0, 0, 33816576,
    0, 0, 134742016, 0, 0, 537919488, 0, 0, 0, 0, 34494480384, 0, 0, 0,
    275415826432, 0, 0, 0, 8830587502592, 0, 0, 0, 0, 0, 0, 0, 2260630401187840,
    0, 0, 0, 0),
    (0, 0, 0, 0, 0, 0, 0, 0, 3584, 3072, 2048, 0, 0, 0, 8192, 24576, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 524288, 0, 1048576, 0, 2097152, 0, 0,
    67633152, 0, 0, 269484032, 0, 0, 1075838976, 8657567744, 0, 0, 0,
    68988960768, 0, 0, 0, 0, 0, 0, 0, 17661175005184, 0, 0, 0, 0, 0, 0,
    0, 4521260802375680, 0, 0, 0),
    (0, 0, 0, 0, 0, 0, 0, 0, 7680, 7168, 6144, 4096, 0, 0, 0, 16384, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1048576, 0, 2097152, 0, 4194304, 0,
    0, 135266304, 0, 0, 538968064, 0, 0, 0, 17315135488, 0, 0, 0,
    137977921536, 0, 0, 2216338391040, 0, 0, 0, 0, 35322350010368, 0,
    0, 0, 0, 0, 0, 0, 9042521604751360, 0, 0),
    (0, 0, 0, 0, 0, 0, 0, 0, 15872, 15360, 14336, 12288, 8192, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2097152, 0, 4194304, 0, 0, 0,
    0, 270532608, 0, 0, 1077936128, 0, 0, 0, 34630270976, 0, 0, 0,
    275955843072, 0, 0, 4432676782080, 0, 0, 0, 0, 70644700020736, 0,
    567382630203392, 0, 0, 0, 0, 0, 18085043209502720, 0),
    (0, 0, 0, 0, 0, 0, 0, 0, 32256, 31744, 30720, 28672, 24576, 16384,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4194304, 0, 8388608,
    0, 0, 0, 0, 541065216, 0, 0, 2155872256, 0, 0, 0, 69260541952, 0,
    0, 0, 551911686144, 0, 0, 8865353564160, 0, 0, 0, 0, 141289400041472,
    0, 1134765260406784, 0, 0, 0, 0, 0, 36170086419005440),
    (256, 0, 512, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 131072,
    393216, 917504, 1966080, 4063232, 8257536, 0, 0, 0, 0, 0, 0, 0, 0,
    16777216, 0, 33554432, 0, 0, 0, 0, 0, 4311744512, 0, 0, 17213423616,
    0, 0, 0, 0, 1103823372288, 0, 0, 0, 8813306445824, 0, 0, 0, 282578800082944,
    0, 0, 0, 0, 4512412933816320, 0, 0),
    (0, 512, 0, 1024, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 262144,
    786432, 1835008, 3932160, 8126464, 0, 0, 0, 0, 0, 0, 0, 0, 0, 33554432, 0,
    67108864, 0, 0, 0, 0, 0, 8623489024, 0, 0, 34426847232, 0, 0, 0, 0,
    2207646744576, 0, 0, 0, 17626612891648, 0, 0, 0, 565157600165888,
    0, 0, 0, 0, 9024825867632640, 0),
    (512, 0, 1024, 0, 2048, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 131072, 0,
    0, 0, 524288, 1572864, 3670016, 7864320, 0, 0, 0, 0, 0, 0, 0, 0,
    33554432, 0, 67108864, 0, 134217728, 0, 0, 0, 0, 0, 17246978048, 0,
    0, 68853694464, 0, 0, 0, 0, 4415293489152, 0, 0, 0, 35253225783296,
    0, 0, 0, 1130315200331776, 0, 0, 0, 0, 18049651735265280),
    (0, 1024, 0, 2048, 0, 4096, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 393216,
    262144, 0, 0, 0, 1048576, 3145728, 7340032, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 67108864, 0, 134217728, 0, 268435456, 0, 0, 8657043456, 0, 0,
    34493956096, 0, 0, 137707388928, 0, 0, 0, 0, 8830586978304, 0, 0,
    0, 70506451566592, 0, 0, 0, 2260630400663552, 0, 0, 0, 0),
    (0, 0, 2048, 0, 4096, 0, 8192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 917504,
    786432, 524288, 0, 0, 0, 2097152, 6291456, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 134217728, 0, 268435456, 0, 536870912, 0, 0, 17314086912, 0,
    0, 68987912192, 0, 0, 275414777856, 2216337342464, 0, 0, 0, 17661173956608,
    0, 0, 0, 0, 0, 0, 0, 4521260801327104, 0, 0, 0),
    (0, 0, 0, 4096, 0, 8192, 0, 16384, 0, 0, 0, 0, 0, 0, 0, 0, 1966080,
    1835008, 1572864, 1048576, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 268435456, 0, 536870912, 0, 1073741824, 0, 0, 34628173824,
    0, 0, 137975824384, 0, 0, 0, 4432674684928, 0, 0, 0, 35322347913216,
    0, 0, 567382628106240, 0, 0, 0, 0, 9042521602654208, 0, 0),
    (0, 0, 0, 0, 8192, 0, 16384, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4063232,
    3932160, 3670016, 3145728, 2097152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 536870912, 0, 1073741824, 0, 0, 0, 0, 69256347648,
    0, 0, 275951648768, 0, 0, 0, 8865349369856, 0, 0, 0, 70644695826432,
    0, 0, 1134765256212480, 0, 0, 0, 0, 18085043205308416, 0),
    (0, 0, 0, 0, 0, 16384, 0, 32768, 0, 0, 0, 0, 0, 0, 0, 0, 8257536,
    8126464, 7864320, 7340032, 6291456, 4194304, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 1073741824, 0, 2147483648, 0, 0, 0, 0,
    138512695296, 0, 0, 551903297536, 0, 0, 0, 17730698739712, 0, 0, 0,
    141289391652864, 0, 0, 2269530512424960, 0, 0, 0, 0, 36170086410616832),
    (65792, 0, 0, 132096, 0, 0, 0, 0, 65536, 0, 131072, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 33554432, 100663296, 234881024, 503316480,
    1040187392, 2113929216, 0, 0, 0, 0, 0, 0, 0, 0, 4294967296, 0, 8589934592,
    0, 0, 0, 0, 0, 1103806595072, 0, 0, 4406636445696, 0, 0, 0, 0,
    282578783305728, 0, 0, 0, 2256206450130944, 0, 0, 0),
    (0, 131584, 0, 0, 264192, 0, 0, 0, 0, 131072, 0, 262144, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 67108864, 201326592, 469762048,
    1006632960, 2080374784, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8589934592, 0,
    17179869184, 0, 0, 0, 0, 0, 2207613190144, 0, 0, 8813272891392, 0,
    0, 0, 0, 565157566611456, 0, 0, 0, 4512412900261888, 0, 0),
    (0, 0, 263168, 0, 0, 528384, 0, 0, 131072, 0, 262144, 0, 524288, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 33554432, 0, 0, 0, 134217728, 402653184,
    939524096, 2013265920, 0, 0, 0, 0, 0, 0, 0, 0, 8589934592, 0, 17179869184,
    0, 34359738368, 0, 0, 0, 0, 0, 4415226380288, 0, 0, 17626545782784,
    0, 0, 0, 0, 1130315133222912, 0, 0, 0, 9024825800523776, 0),
    (262656, 0, 0, 526336, 0, 0, 1056768, 0, 0, 262144, 0, 524288, 0,
    1048576, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100663296, 67108864, 0, 0,
    0, 268435456, 805306368, 1879048192, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    17179869184, 0, 34359738368, 0, 68719476736, 0, 0, 2216203124736,
    0, 0, 8830452760576, 0, 0, 35253091565568, 0, 0, 0, 0, 2260630266445824,
    0, 0, 0, 18049651601047552),
    (0, 525312, 0, 0, 1052672, 0, 0, 2113536, 0, 0, 524288, 0, 1048576,
    0, 2097152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 234881024, 201326592, 134217728, 0,
    0, 0, 536870912, 1610612736, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 34359738368, 0,
    68719476736, 0, 137438953472, 0, 0, 4432406249472, 0, 0, 17660905521152,
    0, 0, 70506183131136, 567382359670784, 0, 0, 0, 4521260532891648, 0, 0, 0),
    (0, 0, 1050624, 0, 0, 2105344, 0, 0, 0, 0, 0, 1048576, 0, 2097152,
    0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 503316480, 469762048, 402653184,
    268435456, 0, 0, 0, 1073741824, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    68719476736, 0, 137438953472, 0, 274877906944, 0, 0, 8864812498944,
    0, 0, 35321811042304, 0, 0, 0, 1134764719341568, 0, 0, 0, 9042521065783296, 0, 0),
    (0, 0, 0, 2101248, 0, 0, 4210688, 0, 0, 0, 0, 0, 2097152, 0, 4194304,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 1040187392, 1006632960, 939524096, 805306368,
    536870912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 137438953472,
    0, 274877906944, 0, 0, 0, 0, 17729624997888, 0, 0, 70643622084608,
    0, 0, 0, 2269529438683136, 0, 0, 0, 18085042131566592, 0),
    (0, 0, 0, 0, 4202496, 0, 0, 8421376, 0, 0, 0, 0, 0, 4194304, 0, 8388608, 0,
    0, 0, 0, 0, 0, 0, 0, 2113929216, 2080374784, 2013265920, 1879048192,
    1610612736, 1073741824, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 274877906944, 0, 549755813888, 0, 0, 0, 0, 35459249995776, 0, 0,
    141287244169216, 0, 0, 0, 4539058877366272, 0, 0, 0, 36170084263133184),
    (16843008, 0, 0, 0, 33818624, 0, 0, 0, 16842752, 0, 0, 33816576, 0,
    0, 0, 0, 16777216, 0, 33554432, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 8589934592, 25769803776, 60129542144, 128849018880, 266287972352,
    541165879296, 0, 0, 0, 0, 0, 0, 0, 0, 1099511627776, 0, 2199023255552,
    0, 0, 0, 0, 0, 282574488338432, 0, 0, 1128098930098176, 0, 0, 0, 0),
    (0, 33686016, 0, 0, 0, 67637248, 0, 0, 0, 33685504, 0, 0, 67633152,
    0, 0, 0, 0, 33554432, 0, 67108864, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 17179869184, 51539607552, 120259084288, 257698037760,
    532575944704, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2199023255552, 0, 4398046511104, 0,
    0, 0, 0, 0, 565148976676864, 0, 0, 2256197860196352, 0, 0, 0),
    (0, 0, 67372032, 0, 0, 0, 135274496, 0, 0, 0, 67371008, 0, 0, 135266304, 0,
    0, 33554432, 0, 67108864, 0, 134217728, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 8589934592, 0, 0, 0, 34359738368, 103079215104, 240518168576,
    515396075520, 0, 0, 0, 0, 0, 0, 0, 0, 2199023255552, 0, 4398046511104,
    0, 8796093022208, 0, 0, 0, 0, 0, 1130297953353728, 0, 0, 4512395720392704, 0, 0),
    (0, 0, 0, 134744064, 0, 0, 0, 270548992, 67239936, 0, 0, 134742016,
    0, 0, 270532608, 0, 0, 67108864, 0, 134217728, 0, 268435456, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 25769803776, 17179869184, 0, 0, 0, 68719476736,
    206158430208, 481036337152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4398046511104,
    0, 8796093022208, 0, 17592186044416, 0, 0, 567347999932416, 0, 0,
    2260595906707456, 0, 0, 9024791440785408, 0),
    (134480384, 0, 0, 0, 269488128, 0, 0, 0, 0, 134479872, 0, 0, 269484032,
    0, 0, 541065216, 0, 0, 134217728, 0, 268435456, 0, 536870912, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 60129542144, 51539607552, 34359738368, 0, 0,
    0, 137438953472, 412316860416, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    8796093022208, 0, 17592186044416, 0, 35184372088832, 0, 0, 1134695999864832,
    0, 0, 4521191813414912, 0, 0, 18049582881570816),
    (0, 268960768, 0, 0, 0, 538976256, 0, 0, 0, 0, 268959744, 0, 0,
    538968064, 0, 0, 0, 0, 0, 268435456, 0, 536870912, 0, 1073741824,
    0, 0, 0, 0, 0, 0, 0, 0, 128849018880, 120259084288, 103079215104,
    68719476736, 0, 0, 0, 274877906944, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 17592186044416, 0, 35184372088832, 0, 70368744177664, 0, 0,
    2269391999729664, 0, 0, 9042383626829824, 0, 0),
    (0, 0, 537921536, 0, 0, 0, 1077952512, 0, 0, 0, 0, 537919488, 0, 0,
    1077936128, 0, 0, 0, 0, 0, 536870912, 0, 1073741824, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 266287972352, 257698037760, 240518168576, 206158430208,
    137438953472, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 35184372088832,
    0, 70368744177664, 0, 0, 0, 0, 4538783999459328, 0, 0, 18084767253659648, 0),
    (0, 0, 0, 1075843072, 0, 0, 0, 2155905024, 0, 0, 0, 0, 1075838976,
    0, 0, 2155872256, 0, 0, 0, 0, 0, 1073741824, 0, 2147483648, 0, 0,
    0, 0, 0, 0, 0, 0, 541165879296, 532575944704, 515396075520, 481036337152,
    412316860416, 274877906944, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 70368744177664, 0, 140737488355328, 0, 0, 0, 0, 9077567998918656, 0,
    0, 36169534507319296),
    (4311810304, 0, 0, 0, 0, 8657571840, 0, 0, 4311810048, 0, 0, 0, 8657567744,
    0, 0, 0, 4311744512, 0, 0, 8657043456, 0, 0, 0, 0, 4294967296, 0,
    8589934592, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2199023255552,
    6597069766656, 15393162788864, 32985348833280, 68169720922112,
    138538465099776, 0, 0, 0, 0, 0, 0, 0, 0, 281474976710656, 0,
    562949953421312, 0, 0, 0, 0, 0),
    (0, 8623620608, 0, 0, 0, 0, 17315143680, 0, 0, 8623620096, 0, 0, 0,
    17315135488, 0, 0, 0, 8623489024, 0, 0, 17314086912, 0, 0, 0, 0,
    8589934592, 0, 17179869184, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 4398046511104, 13194139533312, 30786325577728, 65970697666560,
    136339441844224, 0, 0, 0, 0, 0, 0, 0, 0, 0, 562949953421312, 0,
    1125899906842624, 0, 0, 0, 0),
    (0, 0, 17247241216, 0, 0, 0, 0, 34630287360, 0, 0, 17247240192, 0,
    0, 0, 34630270976, 0, 0, 0, 17246978048, 0, 0, 34628173824, 0, 0,
    8589934592, 0, 17179869184, 0, 34359738368, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 2199023255552, 0, 0, 0, 8796093022208, 26388279066624,
    61572651155456, 131941395333120, 0, 0, 0, 0, 0, 0, 0, 0, 562949953421312, 0,
    1125899906842624, 0, 2251799813685248, 0, 0, 0),
    (0, 0, 0, 34494482432, 0, 0, 0, 0, 0, 0, 0, 34494480384, 0, 0, 0,
    69260541952, 17213423616, 0, 0, 34493956096, 0, 0, 69256347648, 0,
    0, 17179869184, 0, 34359738368, 0, 68719476736, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 6597069766656, 4398046511104, 0, 0, 0, 17592186044416,
    52776558133248, 123145302310912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1125899906842624,
    0, 2251799813685248, 0, 4503599627370496, 0, 0),
    (0, 0, 0, 0, 68988964864, 0, 0, 0, 34426978304, 0, 0, 0, 68988960768,
    0, 0, 0, 0, 34426847232, 0, 0, 68987912192, 0, 0, 138512695296, 0,
    0, 34359738368, 0, 68719476736, 0, 137438953472, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 15393162788864, 13194139533312, 8796093022208, 0, 0, 0,
    35184372088832, 105553116266496, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    2251799813685248, 0, 4503599627370496, 0, 9007199254740992, 0),
    (68853957120, 0, 0, 0, 0, 137977929728, 0, 0, 0, 68853956608, 0, 0,
    0, 137977921536, 0, 0, 0, 0, 68853694464, 0, 0, 137975824384, 0, 0,
    0, 0, 0, 68719476736, 0, 137438953472, 0, 274877906944, 0, 0, 0, 0,
    0, 0, 0, 0, 32985348833280, 30786325577728, 26388279066624, 17592186044416,
    0, 0, 0, 70368744177664, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4503599627370496,
    0, 9007199254740992, 0, 18014398509481984),
    (0, 137707914240, 0, 0, 0, 0, 275955859456, 0, 0, 0, 137707913216,
    0, 0, 0, 275955843072, 0, 0, 0, 0, 137707388928, 0, 0, 275951648768,
    0, 0, 0, 0, 0, 137438953472, 0, 274877906944, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 68169720922112, 65970697666560, 61572651155456, 52776558133248,
    35184372088832, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    9007199254740992, 0, 18014398509481984, 0),
    (0, 0, 275415828480, 0, 0, 0, 0, 551911718912, 0, 0, 0, 275415826432,
    0, 0, 0, 551911686144, 0, 0, 0, 0, 275414777856, 0, 0, 551903297536,
    0, 0, 0, 0, 0, 274877906944, 0, 549755813888, 0, 0, 0, 0, 0, 0, 0,
    0, 138538465099776, 136339441844224, 131941395333120, 123145302310912,
    105553116266496, 70368744177664, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 18014398509481984, 0, 36028797018963968),
    (1103823438080, 0, 0, 0, 0, 0, 2216338399232, 0, 1103823437824, 0,
    0, 0, 0, 2216338391040, 0, 0, 1103823372288, 0, 0, 0, 2216337342464,
    0, 0, 0, 1103806595072, 0, 0, 2216203124736, 0, 0, 0, 0, 1099511627776, 0,
    2199023255552, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 562949953421312,
    1688849860263936, 3940649673949184, 8444249301319680, 17451448556060672,
    35465847065542656, 0, 0, 0, 0, 0, 0, 0, 0),
    (0, 2207646876160, 0, 0, 0, 0, 0, 4432676798464, 0, 2207646875648,
    0, 0, 0, 0, 4432676782080, 0, 0, 2207646744576, 0, 0, 0, 4432674684928, 0,
    0, 0, 2207613190144, 0, 0, 4432406249472, 0, 0, 0, 0, 2199023255552,
    0, 4398046511104, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    1125899906842624, 3377699720527872, 7881299347898368, 16888498602639360,
    34902897112121344, 0, 0, 0, 0, 0, 0, 0, 0),
    (0, 0, 4415293752320, 0, 0, 0, 0, 0, 0, 0, 4415293751296, 0, 0, 0,
    0, 8865353564160, 0, 0, 4415293489152, 0, 0, 0, 8865349369856, 0,
    0, 0, 4415226380288, 0, 0, 8864812498944, 0, 0, 2199023255552, 0,
    4398046511104, 0, 8796093022208, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    562949953421312, 0, 0, 0, 2251799813685248, 6755399441055744,
    15762598695796736, 33776997205278720, 0, 0, 0, 0, 0, 0, 0, 0),
    (0, 0, 0, 8830587504640, 0, 0, 0, 0, 0, 0, 0, 8830587502592, 0, 0,
    0, 0, 0, 0, 0, 8830586978304, 0, 0, 0, 17730698739712, 4406636445696,
    0, 0, 8830452760576, 0, 0, 17729624997888, 0, 0, 4398046511104, 0,
    8796093022208, 0, 17592186044416, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    1688849860263936, 1125899906842624, 0, 0, 0, 4503599627370496,
    13510798882111488, 31525197391593472, 0, 0, 0, 0, 0, 0, 0, 0),
    (0, 0, 0, 0, 17661175009280, 0, 0, 0, 0, 0, 0, 0, 17661175005184, 0,
    0, 0, 8813306445824, 0, 0, 0, 17661173956608, 0, 0, 0, 0, 8813272891392,
    0, 0, 17660905521152, 0, 0, 35459249995776, 0, 0, 8796093022208, 0,
    17592186044416, 0, 35184372088832, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    3940649673949184, 3377699720527872, 2251799813685248, 0, 0, 0,
    9007199254740992, 27021597764222976, 0, 0, 0, 0, 0, 0, 0, 0),
    (0, 0, 0, 0, 0, 35322350018560, 0, 0, 17626613022720, 0, 0, 0, 0,
    35322350010368, 0, 0, 0, 17626612891648, 0, 0, 0, 35322347913216,
    0, 0, 0, 0, 17626545782784, 0, 0, 35321811042304, 0, 0, 0, 0, 0,
    17592186044416, 0, 35184372088832, 0, 70368744177664, 0, 0, 0, 0,
    0, 0, 0, 0, 8444249301319680, 7881299347898368, 6755399441055744,
    4503599627370496, 0, 0, 0, 18014398509481984, 0, 0, 0, 0, 0, 0, 0, 0),
    (35253226045952, 0, 0, 0, 0, 0, 70644700037120, 0, 0, 35253226045440,
    0, 0, 0, 0, 70644700020736, 0, 0, 0, 35253225783296, 0, 0, 0,
    70644695826432, 0, 0, 0, 0, 35253091565568, 0, 0, 70643622084608,
    0, 0, 0, 0, 0, 35184372088832, 0, 70368744177664, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 17451448556060672, 16888498602639360, 15762598695796736,
    13510798882111488, 9007199254740992, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
    (0, 70506452091904, 0, 0, 0, 0, 0, 141289400074240, 0, 0, 70506452090880,
    0, 0, 0, 0, 141289400041472, 0, 0, 0, 70506451566592, 0, 0, 0,
    141289391652864, 0, 0, 0, 0, 70506183131136, 0, 0, 141287244169216,
    0, 0, 0, 0, 0, 70368744177664, 0, 140737488355328, 0, 0, 0, 0, 0,
    0, 0, 0, 35465847065542656, 34902897112121344, 33776997205278720,
    31525197391593472, 27021597764222976, 18014398509481984, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
    (282578800148736, 0, 0, 0, 0, 0, 0, 567382630219776, 282578800148480,
    0, 0, 0, 0, 0, 567382630203392, 0, 282578800082944, 0, 0, 0, 0,
    567382628106240, 0, 0, 282578783305728, 0, 0, 0, 567382359670784,
    0, 0, 0, 282574488338432, 0, 0, 567347999932416, 0, 0, 0, 0,
    281474976710656, 0, 562949953421312, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 144115188075855872, 432345564227567616, 1008806316530991104,
    2161727821137838080, 4467570830351532032, 9079256848778919936),
    (0, 565157600297472, 0, 0, 0, 0, 0, 0, 0, 565157600296960, 0, 0, 0,
    0, 0, 1134765260406784, 0, 565157600165888, 0, 0, 0, 0, 1134765256212480, 0,
    0, 565157566611456, 0, 0, 0, 1134764719341568, 0, 0, 0, 565148976676864,
    0, 0, 1134695999864832, 0, 0, 0, 0, 562949953421312, 0, 1125899906842624, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 288230376151711744,
    864691128455135232, 2017612633061982208, 4323455642275676160, 8935141660703064064),
    (0, 0, 1130315200594944, 0, 0, 0, 0, 0, 0, 0, 1130315200593920, 0,
    0, 0, 0, 0, 0, 0, 1130315200331776, 0, 0, 0, 0, 2269530512424960,
    0, 0, 1130315133222912, 0, 0, 0, 2269529438683136, 0, 0, 0, 1130297953353728,
    0, 0, 2269391999729664, 0, 0, 562949953421312, 0, 1125899906842624,
    0, 2251799813685248, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 144115188075855872, 0,
    0, 0, 576460752303423488, 1729382256910270464, 4035225266123964416,
    8646911284551352320),
    (0, 0, 0, 2260630401189888, 0, 0, 0, 0, 0, 0, 0, 2260630401187840,
    0, 0, 0, 0, 0, 0, 0, 2260630400663552, 0, 0, 0, 0, 0, 0, 0, 2260630266445824,
    0, 0, 0, 4539058877366272, 1128098930098176, 0, 0, 2260595906707456,
    0, 0, 4538783999459328, 0, 0, 1125899906842624, 0, 2251799813685248,
    0, 4503599627370496, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 432345564227567616,
    288230376151711744, 0, 0, 0, 1152921504606846976, 3458764513820540928,
    8070450532247928832),
    (0, 0, 0, 0, 4521260802379776, 0, 0, 0, 0, 0, 0, 0, 4521260802375680,
    0, 0, 0, 0, 0, 0, 0, 4521260801327104, 0, 0, 0, 2256206450130944,
    0, 0, 0, 4521260532891648, 0, 0, 0, 0, 2256197860196352, 0, 0,
    4521191813414912, 0, 0, 9077567998918656, 0, 0, 2251799813685248,
    0, 4503599627370496, 0, 9007199254740992, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 1008806316530991104, 864691128455135232, 576460752303423488, 0,
    0, 0, 2305843009213693952, 6917529027641081856),
    (0, 0, 0, 0, 0, 9042521604759552, 0, 0, 0, 0, 0, 0, 0, 9042521604751360, 0,
    0, 4512412933816320, 0, 0, 0, 0, 9042521602654208, 0, 0, 0, 4512412900261888,
    0, 0, 0, 9042521065783296, 0, 0, 0, 0, 4512395720392704, 0, 0,
    9042383626829824, 0, 0, 0, 0, 0, 4503599627370496, 0, 9007199254740992, 0,
    18014398509481984, 0, 0, 0, 0, 0, 0, 0, 0, 2161727821137838080,
    2017612633061982208, 1729382256910270464, 1152921504606846976, 0,
    0, 0, 4611686018427387904),
    (0, 0, 0, 0, 0, 0, 18085043209519104, 0, 9024825867763712, 0, 0, 0,
    0, 0, 18085043209502720, 0, 0, 9024825867632640, 0, 0, 0, 0,
    18085043205308416, 0, 0, 0, 9024825800523776, 0, 0, 0, 18085042131566592, 0,
    0, 0, 0, 9024791440785408, 0, 0, 18084767253659648, 0, 0, 0, 0, 0,
    9007199254740992, 0, 18014398509481984, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    4467570830351532032, 4323455642275676160, 4035225266123964416,
    3458764513820540928, 2305843009213693952, 0, 0, 0),
    (18049651735527936, 0, 0, 0, 0, 0, 0, 36170086419038208, 0, 18049651735527424,
    0, 0, 0, 0, 0, 36170086419005440, 0, 0, 18049651735265280, 0, 0, 0,
    0, 36170086410616832, 0, 0, 0, 18049651601047552, 0, 0, 0, 36170084263133184,
    0, 0, 0, 0, 18049582881570816, 0, 0, 36169534507319296, 0, 0, 0, 0,
    0, 18014398509481984, 0, 36028797018963968, 0, 0, 0, 0, 0, 0, 0, 0,
    9079256848778919936, 8935141660703064064, 8646911284551352320,
    8070450532247928832, 6917529027641081856, 4611686018427387904, 0, 0));


function BitBoardToStr(ABitBoard: TBitBoard): string;
function IsBitSet(ABitBoard: TBitBoard; Index: byte): boolean; inline;
function NumberOfLeadingZeroes(const ABitBoard: TBitBoard): integer; inline;
function NumberOfTrailingZeroes(const ABitBoard: TBitBoard): integer; inline;
function ReverseBitBoard(ABitBoard: TBitBoard): TBitBoard;

implementation

function BitBoardToStr(ABitBoard: TBitBoard): string;
var
  j: integer;
begin
  Result := '';
  for j := 1 to 64 do
  begin
    if (ABitBoard and 1) = 1 then
      Result := Result + '1'
    else
      Result := Result + '0';
    ABitBoard := ABitBoard shr 1;
  end;
  for j := 8 downto 1 do
    Insert(LineEnding, Result, j * 8 + 1);
end;

function IsBitSet(ABitBoard: TBitBoard; Index: byte): boolean; inline;
begin
  Result := ((ABitBoard shr Index) and 1) = 1;
end;

function NumberOfLeadingZeroes(const ABitBoard: TBitBoard): integer; inline;
begin
  Result := 63 - BsrQWord(ABitBoard);
end;

function NumberOfTrailingZeroes(const ABitBoard: TBitBoard): integer; inline;
begin
  Result := BsfQWord(ABitBoard);
end;

function ReverseBitBoard(ABitBoard: TBitBoard): TBitBoard;
begin
  // based on http://graphics.stanford.edu/~seander/bithacks.html#ReverseParallel
  // swap odd and even bits
  ABitBoard := ((ABitBoard shr 1) and $5555555555555555) or
    ((ABitBoard and $5555555555555555) shl 1);
  // swap consecutive pairs
  ABitBoard := ((ABitBoard shr 2) and $3333333333333333) or
    ((ABitBoard and $3333333333333333) shl 2);
  // swap nibbles ...
  ABitBoard := ((ABitBoard shr 4) and $0F0F0F0F0F0F0F0F) or
    ((ABitBoard and $0F0F0F0F0F0F0F0F) shl 4);
  // swap bytes
  ABitBoard := ((ABitBoard shr 8) and $00FF00FF00FF00FF) or
    ((ABitBoard and $00FF00FF00FF00FF) shl 8);
  // swap 2-byte long pairs
  ABitBoard := ((ABitBoard shr 16) and $0000FFFF0000FFFF) or
    ((ABitBoard and $0000FFFF0000FFFF) shl 16);
  // swap 4-byte long pairs
  Result := (ABitBoard shr 32) or (ABitBoard shl 32);
end;

end.
